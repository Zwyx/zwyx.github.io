<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-list-page plugin-blog plugin-id-til" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.6.1">
<title data-rh="true">Zwyx&#x27;s Today I Learnt | Zwyx</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://zwyx.dev/img/Zwyx-236x236-android-chrome-192x192.webp"><meta data-rh="true" name="twitter:image" content="https://zwyx.dev/img/Zwyx-236x236-android-chrome-192x192.webp"><meta data-rh="true" property="og:url" content="https://zwyx.dev/til"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="keywords" content="software development, web"><meta data-rh="true" property="og:title" content="Zwyx&#x27;s Today I Learnt | Zwyx"><meta data-rh="true" name="description" content="Today I Learnt, about web and dev"><meta data-rh="true" property="og:description" content="Today I Learnt, about web and dev"><meta data-rh="true" name="docusaurus_tag" content="blog_posts_list"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_posts_list"><link data-rh="true" rel="icon" href="/img/Zwyx-220x220-rounded-favicon.ico"><link data-rh="true" rel="canonical" href="https://zwyx.dev/til"><link data-rh="true" rel="alternate" href="https://zwyx.dev/til" hreflang="en"><link data-rh="true" rel="alternate" href="https://zwyx.dev/til" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://ECBLYDEE9A-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"Blog","@id":"https://zwyx.dev/til","mainEntityOfPage":"https://zwyx.dev/til","headline":"Zwyx's Today I Learnt","description":"Today I Learnt, about web and dev","blogPost":[{"@type":"BlogPosting","@id":"https://zwyx.dev/til/2024/03/27/interactive-widget","mainEntityOfPage":"https://zwyx.dev/til/2024/03/27/interactive-widget","url":"https://zwyx.dev/til/2024/03/27/interactive-widget","headline":"interactive-widget","name":"interactive-widget","description":"The viewport meta tag option interactive-widget allows us to choose what the browser should do with our page when some overlay elements — such as a phone on-screen keyboard — appear:","datePublished":"2024-03-27T00:00:00.000Z","author":[],"keywords":[]},{"@type":"BlogPosting","@id":"https://zwyx.dev/til/2024/02/01/Fast integer-to-string conversion","mainEntityOfPage":"https://zwyx.dev/til/2024/02/01/Fast integer-to-string conversion","url":"https://zwyx.dev/til/2024/02/01/Fast integer-to-string conversion","headline":"Fast integer-to-string conversion","name":"Fast integer-to-string conversion","description":"This content kept growing, so it has been moved into a blog post.","datePublished":"2024-02-01T00:00:00.000Z","author":[],"keywords":[]},{"@type":"BlogPosting","@id":"https://zwyx.dev/til/2023/12/31/Fast string-to-integer conversion","mainEntityOfPage":"https://zwyx.dev/til/2023/12/31/Fast string-to-integer conversion","url":"https://zwyx.dev/til/2023/12/31/Fast string-to-integer conversion","headline":"Fast string-to-integer conversion","name":"Fast string-to-integer conversion","description":"This content kept growing, so it has been moved into a blog post.","datePublished":"2023-12-31T00:00:00.000Z","author":[],"keywords":[]},{"@type":"BlogPosting","@id":"https://zwyx.dev/til/2023/06/30/GPU rasterization in Chrome","mainEntityOfPage":"https://zwyx.dev/til/2023/06/30/GPU rasterization in Chrome","url":"https://zwyx.dev/til/2023/06/30/GPU rasterization in Chrome","headline":"GPU rasterization in Chrome","name":"GPU rasterization in Chrome","description":"In case of weird text rendering issues in Chrome looking like this:","datePublished":"2023-06-30T00:00:00.000Z","author":[],"keywords":[]},{"@type":"BlogPosting","@id":"https://zwyx.dev/til/2023/01/12/xclip and xsel","mainEntityOfPage":"https://zwyx.dev/til/2023/01/12/xclip and xsel","url":"https://zwyx.dev/til/2023/01/12/xclip and xsel","headline":"xclip and xsel","name":"xclip and xsel","description":"xclip is a command line utility to get or set content in the X selection or clipboard.","datePublished":"2023-01-12T00:00:00.000Z","author":[],"keywords":[]},{"@type":"BlogPosting","@id":"https://zwyx.dev/til/2022/12/19/inotify watches","mainEntityOfPage":"https://zwyx.dev/til/2022/12/19/inotify watches","url":"https://zwyx.dev/til/2022/12/19/inotify watches","headline":"inotify watches","name":"inotify watches","description":"Check how many inotify watches are being used:","datePublished":"2022-12-19T00:00:00.000Z","author":[],"keywords":[]},{"@type":"BlogPosting","@id":"https://zwyx.dev/til/2022/12/19/rsync and file renames","mainEntityOfPage":"https://zwyx.dev/til/2022/12/19/rsync and file renames","url":"https://zwyx.dev/til/2022/12/19/rsync and file renames","headline":"rsync and file renames","name":"rsync and file renames","description":"rsync doesn't handle file/folder renames well: if a folder containing lots of big files (a photos/videos library) is renamed in the source, then the existing files in the destination will be deleted, and all files will be copied again to the destination.","datePublished":"2022-12-19T00:00:00.000Z","author":[],"keywords":[]},{"@type":"BlogPosting","@id":"https://zwyx.dev/til/2022/12/05/JSON stringify circular references","mainEntityOfPage":"https://zwyx.dev/til/2022/12/05/JSON stringify circular references","url":"https://zwyx.dev/til/2022/12/05/JSON stringify circular references","headline":"JSON stringify circular references","name":"JSON stringify circular references","description":"Not really a TIL, but more a knack","datePublished":"2022-12-05T00:00:00.000Z","author":[],"keywords":[]},{"@type":"BlogPosting","@id":"https://zwyx.dev/til/2022/11/23/wget for FTP","mainEntityOfPage":"https://zwyx.dev/til/2022/11/23/wget for FTP","url":"https://zwyx.dev/til/2022/11/23/wget for FTP","headline":"wget for FTP","name":"wget for FTP","description":"Download the content of an FTP folder with wget:","datePublished":"2022-11-23T00:00:00.000Z","author":[],"keywords":[]}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Zwyx&#39;s blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Zwyx&#39;s blog Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="Zwyx&#39;s blog JSON Feed">



<link rel="search" type="application/opensearchdescription+xml" title="Zwyx" href="/opensearch.xml">
<link rel="alternate" type="application/rss+xml" href="/til/rss.xml" title="Zwyx&#39;s TILs RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/til/atom.xml" title="Zwyx&#39;s TILs Atom Feed">
<link rel="alternate" type="application/json" href="/til/feed.json" title="Zwyx&#39;s TILs JSON Feed">
<script src="https://plsbl.zwyx.dev/js/script.js" defer="defer" data-domain="zwyx.dev"></script><link rel="stylesheet" href="/assets/css/styles.0d8ef3f6.css">
<script src="/assets/js/runtime~main.a21e526b.js" defer="defer"></script>
<script src="/assets/js/main.60e7c5e2.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();null!==e?t(e):window.matchMedia("(prefers-color-scheme: dark)").matches?t("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,t("light"))}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/Zwyx-236x236-android-chrome-192x192.webp" alt="Zwyx logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/Zwyx-236x236-android-chrome-192x192.webp" alt="Zwyx logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a class="navbar__item navbar__link" href="/blog">Blog</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/til">Today I Learnt</a></div><div class="navbar__items navbar__items--right"><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div><a href="https://github.com/Zwyx" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Latest TILs</div><div role="group"><h3 class="yearGroupHeading_rMGB">2024</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/til/2024/03/27/interactive-widget">interactive-widget</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/til/2024/02/01/Fast integer-to-string conversion">Fast integer-to-string conversion</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2023</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/til/2023/12/31/Fast string-to-integer conversion">Fast string-to-integer conversion</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/til/2023/06/30/GPU rasterization in Chrome">GPU rasterization in Chrome</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/til/2023/01/12/xclip and xsel">xclip and xsel</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2022</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/til/2022/12/19/inotify watches">inotify watches</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/til/2022/12/19/rsync and file renames">rsync and file renames</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/til/2022/12/05/JSON stringify circular references">JSON stringify circular references</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/til/2022/11/23/wget for FTP">wget for FTP</a></li></ul></div></nav></aside><main class="col col--7"><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/til/2024/03/27/interactive-widget">interactive-widget</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-03-27T00:00:00.000Z">March 27, 2024</time></div></header><div class="markdown"><p>The <code>viewport</code> meta tag option <code>interactive-widget</code> allows us to choose what the browser should do with our page when some overlay elements — such as a phone on-screen keyboard — appear:</p>
<!-- -->
<div class="imageWrapper_u91s withLegend_q8O0"><div class="frame_zT4L"><img class="image_Y_cJ" src="/assets/images/2024-03-27-interactive-widget-visual-comparison-all-ff711d1c9df866930cdc6b23602ac624.webp" alt="interactive-widget options comparison"></div><div class="legend_xj0V"><code>interactive-widget</code> options comparison. The difference between<!-- --> <code>resizes-visual</code> and <code>overlays-content</code> is that<!-- --> <code>resizes-visual</code> allows the user to scroll the page up to see the sticky element at the bottom, whereas <code>overlays-content</code> <!-- -->doesn&#x27;t.</div></div>
<p>Chrome&#x27;s default behaviour on Android, before version 108, was <code>resizes-content</code> — it is now <code>resizes-visual</code>.</p>
<p>For example, the <a href="https://babel.zwyx.dev/" target="_blank" rel="noopener noreferrer">Library of Babel</a> <code>viewport</code> meta tag is now:</p>
<div class="language-html codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-html codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">meta</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">	</span><span class="token tag attr-name" style="color:#00a4db">name</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">viewport</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">	</span><span class="token tag attr-name" style="color:#00a4db">content</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">width=device-width, initial-scale=1.0, interactive-widget=resizes-content</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f"></span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This allows the sticky pagination component to be always visible when the on-screen keyboard is open:</p>
<div style="text-align:center"><div class="imageWrapper_u91s withLegend_q8O0"><div class="frame_zT4L"><img class="image_Y_cJ" src="/assets/images/2024-03-27-interactive-widget-babel-2b3e7ed27a3f3bce5ac7359e6cff7ecb.webp" alt="Example on the Library of Babel" width="350"></div><div class="legend_xj0V">The keyboard is<!-- --> <a href="https://github.com/dessalines/thumb-key" target="_blank" rel="noopener noreferrer">Thumb-Key</a>.</div></div></div>
<p>Without <code>interactive-widget</code>, scrolling down while the keyboard was open made the sticky pagination component to disappear.</p>
<p>Read more at <a href="https://developer.chrome.com/blog/viewport-resize-behavior" target="_blank" rel="noopener noreferrer">developer.chrome.com/blog/viewport-resize-behavior</a> (which is the source of the comparison image above).</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/til/tags/viewport">viewport</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/til/2024/02/01/Fast integer-to-string conversion">Fast integer-to-string conversion</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2024-02-01T00:00:00.000Z">February 1, 2024</time></div></header><div class="markdown"><p>This content kept growing, so it has been moved into a <a href="/blog/base-conversions-with-big-numbers-in-javascript">blog post</a>.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/til/tags/javascript">javascript</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/til/tags/v-8">v8</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/til/tags/string">string</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/til/tags/integer">integer</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/til/2023/12/31/Fast string-to-integer conversion">Fast string-to-integer conversion</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-12-31T00:00:00.000Z">December 31, 2023</time></div></header><div class="markdown"><p>This content kept growing, so it has been moved into a <a href="/blog/base-conversions-with-big-numbers-in-javascript">blog post</a>.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/til/tags/javascript">javascript</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/til/tags/v-8">v8</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/til/tags/string">string</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/til/tags/integer">integer</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/til/2023/06/30/GPU rasterization in Chrome">GPU rasterization in Chrome</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-06-30T00:00:00.000Z">June 30, 2023</time></div></header><div class="markdown"><p>In case of weird text rendering issues in Chrome looking like this:</p>
<p><img decoding="async" loading="lazy" alt="Text issue" src="data:image/webp;base64,UklGRowHAABXRUJQVlA4IIAHAACQKACdASpqAC8APjEUh0KiIQvOzowQAYJQBmYuhzL1l7AcRS216ANtf+IHsL/Yr1uPQB5rvpN+pR/Ov8P7AH7Aeml7H/91/5XpmatJ0A7Jv6X+Qnm33ku2HrN+Om+s/sH4ze4f8S+q31b8lv6j+6HElfs3qBem/6t+WfBM0U/tfqBepXzT/G/mB5H38B+QHuZ9Kf8B6Cv9m/Kr+pfCv9J/zPiDdgf1X3AP4n/Lf8R/c/2o/vX0dftH+5/t35Heyb8l/rf+v/xXwB/yP+ef53+5/ur/nv//9O/sI/bf2Q/1zY21m+dEgSFn10Zai6oDQ3pL0WpskwzW6lYRrmCf/LmPWky9DUn97hX/fTkBtS3g+/6U1wkDqF/BU13OX3//BLxoRiQbOMmQKko3T+FNFQC+pmwF/reoziciFm6nm/SdUxKE5SD13ld9cIJyeFwA/v/7OATefdES2mbQXP1+sqyYnsJMeQjD525Odpl5FmTM5kKqo73jxr8keTzVSW0Qr+NofLGR7MFhpSPLTmU0QqN1ZvOeA1NT5cBtEpgVhMySOfgZbtGw15WOY7DRfOuvjBThi7i3HPyLG+lhjsXlH/vWNmf97KoeWdQOeO2dbdUUj8V1UQvwgKE5Ks2GxVx0Ux6mOHdudbOKRhFmLlLFEucdysqA77LRp4ba155FZEypPzkcZsLhnrp4INu/9TCeFQXnqYPG0bK14J8TZqFWDoIZFSeiBvFAbQwi25eM05iPwyorW2hJz7H+Ffhlcz6H8sIiRv8CmeJ+EeQj+fcNSwr8Yj2cTSP2wktflr1V1rZaQ/Djs0dY/cl/RAe3QcY9D1v7l3zONnsRbTvOgI6G2okF9hrXOEddn/uM8PqyQyjpNiiQ6g8Za81ZAfmsim4bUBFljh+e/i8p/XPdqA8N0GxSqfqxanESpLxFTwEF8cEMRrFet6L6k3al0plcpAnZzHZKss+vrtRd5UENRpn5zD5HOGRVcuKtIniWfwj7fwoC3Oe+kuNwzksGYGgs+/5VgQlkYQdDBfSSVniItynHSxNs1PYLGe1csB5j7WytoL7OcN2jZ889iOMNOgOhV/G2NGL7E/guMwdy92d6Oz96/l1dlvYst93HiHus/u6wU0WjGAb+NQXrm+vo6YxU0S1DXnWImk+/kXOyS6W9HNDN4wz4RpOGwNYNZ7MnFqZZaQHfkNo+qMFiqGM1H40CQyPGTn65F2xo6dd4hOZZf+dqfd8bwnbkbsUws8zed8axH18mvjtsXsCluBMv8TTxxkD3yIkNkq4CSyhFCGvqjaZtlII/BspjiotRkfzRbKPEFnLd/HXKhD8FCgft9BNWj+iblIaYubtUSqSXF4/Rp1NlTzpiV80v1UzoDSZNjhomp9g/BV34RwmqRgZ1ZYIN/YMShkr4U9ocTZduxMj1co3XvjLrTLHpg85gJDwukrkN3sNS3R5McaGMrD/fuJ1WQZfgH+IyMV4GQLbQ8gUoDMMPk4EjLmeHXFGkN95EvYQWP3sqZqLgMcIft2Drw4ozYV+SSbDQbp22EXC6wKTcmtEl1wohLCiSwA3UnyUnU6OzqFZ83LIMf+M03kDHyc4KM0ixcWt8zy+tM5nOPhLGILK9yX77v8QSLwJ0xL5eI/TzH0oJ0soYnywHX/afXAEzaTqiQzL24v5I1DSgsFBEUdyuTyyrXBtC/6PEkj0DPdpYNNsfIhu3u7h4WfjDexenIM82n4Qx4XwdmTcXPH73jaAYuQg2e03WF6ozmSAlRVvCabnl8FO7s31xFjWUmFl1FCTefMmflxUZFl3LeQu9s+nbeGnOE41kfT7qBD//zJA9wieBTXK3LCsK0klH1aQmelxLux1uvgO4Lrl/D2rNtt0h+lKWtSinvzP20XRke5Ynwy8DkyHvQrJOe146pCD7bMvxGHW392H+zt74mD9K3X7NmorHQyYeVpG19033N9fYStZvPR+hV/92U3JrUSPI5KtrdEyCsP5/T6nS1qUReIVFQmiFds/LbutHVph6SQwpAo5zp9HuMtN6ZLMd3uVZpMKnvvhnh8Bz1u8occ6Fff+rP9egGNt/5YaTL21LiTmxAeNfNHVdDRRH0XR9hVa7fmPl/qQEHEHnGsSu1eS1bfBEm1xKlaaKxvJyz0IVQ0RmuMTaQPbr6mtK5NEDaUg4/I+LHGnnOgxHcMMv11SWSKB6SvpAjHIodFO0GyZHRFY+4EE/f9CeS10bMR6yZJ9n9ewsBC4jA+7SEsRk1OXpiWLLJkGqhfmoIvf6GACwSP555wDZyLxjxpUpuyAeuCjvSvverfvx2fIO+Gp/9WSWf8Qs0Rf8PXQP2KAYwiI+TZVdq4TpWceIGaXahHwCeM0PGQIOEtp5eEVa8HhXYfvcTjWvzXMwAMBlM/BnzXUuZNQu4Wm7dcoEvWTrU5IUvr+XdgUzU1V43eK0p3MK1Irkr5vlcZvVcCmyrpLV/+Q6BSZZM8lOCCpTrNP1WXzG6C4rqFIJPOgkB+VdhldAjfoErdfqxVf9vjMY1LC775xXiivX1ZSjA3NusrNFYTfPP5tkueyAAAA=" width="106" height="47" class="img_ev3q"></p>
<p>chanche <code>chrome://flags/#enable-gpu-rasterization</code> from <code>Default</code> to <code>Disabled</code>.</p>
<p>(It&#x27;s actually happening very rarely for me, so I put back the setting to <code>Default</code>.)</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/til/tags/chrome">chrome</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/til/2023/01/12/xclip and xsel">xclip and xsel</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2023-01-12T00:00:00.000Z">January 12, 2023</time></div></header><div class="markdown"><p><code>xclip</code> is a command line utility to get or set content in the X selection or clipboard.</p>
<p>It has a strange side effect when used to set things in the clipboard, it make the terminal to hang for a couple of seconds when closed, and more annoyingly it prevent Sublime Merge to terminate a command making use of it. This is probably linked to the fact that <code>xclip</code> starts a background process and leaves it running, as it is necessary for when the clipboard content is retrieved.</p>
<p>After tinkering with it, I wasn&#x27;t able make it work better. However I discovered <code>xsel</code>, which doesn&#x27;t the same things without this unwanted side effect.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/til/tags/xclip">xclip</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/til/tags/xsel">xsel</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/til/2022/12/19/inotify watches">inotify watches</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2022-12-19T00:00:00.000Z">December 19, 2022</time></div></header><div class="markdown"><p>Check how many inotify watches are being used:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token shebang important">#!/bin/bash</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Get the procs sorted by the number of inotify watches</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># @author Carl-Erik Kopseng</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># @latest https://github.com/fatso83/dotfiles/blob/master/utils/scripts/inotify-consumers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># Discussion leading up to answer: https://unix.stackexchange.com/questions/15509/whos-consuming-my-inotify-resources</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># If you need ultimate speed, use https://github.com/fatso83/dotfiles/commit/inotify-consumers-v1-fastest</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># # Speed enhancements by Simon Matter &lt;simon.matter@invoca.ch&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># A later PR introduced a significant slowdown to gain better output, but it is insignificant on most machines</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># See this for details: https://github.com/fatso83/dotfiles/pull/10#issuecomment-1122374716</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function-name function" style="color:#d73a49">main</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">printf</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c">%</span><span class="token string variable" style="color:#36acaa">${WLEN}</span><span class="token string" style="color:#e3116c">s  %</span><span class="token string variable" style="color:#36acaa">${WLEN}</span><span class="token string" style="color:#e3116c">s</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;INOTIFY&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;INSTANCES&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">printf</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;%</span><span class="token string variable" style="color:#36acaa">${WLEN}</span><span class="token string" style="color:#e3116c">s  %</span><span class="token string variable" style="color:#36acaa">${WLEN}</span><span class="token string" style="color:#e3116c">s</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;WATCHES&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;PER   &quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">printf</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;%</span><span class="token string variable" style="color:#36acaa">${WLEN}</span><span class="token string" style="color:#e3116c">s  %</span><span class="token string variable" style="color:#36acaa">${WLEN}</span><span class="token string" style="color:#e3116c">s  %s</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot; COUNT &quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;PROCESS &quot;</span><span class="token plain">    </span><span class="token string" style="color:#e3116c">&quot;PID USER         COMMAND&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">printf</span><span class="token plain"> -- </span><span class="token string" style="color:#e3116c">&quot;------------------------------------------------------------</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    generateData</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function-name function" style="color:#d73a49">usage</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">Usage: </span><span class="token string variable" style="color:#36acaa">$0</span><span class="token string" style="color:#e3116c"> [--help|--limits]</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    -l, --limits    Will print the current related limits and how to change them</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    -h, --help      Show this help</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">FYI:  Check out Michael Sartain&#x27;s C++ take on this script. The native executable</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      is much faster, modern and feature rich. It can be found at</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">      https://github.com/mikesart/inotify-info</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">EOF</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function-name function" style="color:#d73a49">limits</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">printf</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c">Current limits</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c">-------------</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">sysctl</span><span class="token plain"> fs.inotify.max_user_instances fs.inotify.max_user_watches</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&lt;-</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">EOF</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">Changing settings permanently</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">-----------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">echo fs.inotify.max_user_watches=524288 | sudo tee -a /etc/sysctl.conf</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">sudo sysctl -p # re-read config</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">EOF</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token function-name function" style="color:#d73a49">generateData</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">local</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-i</span><span class="token plain"> PROC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">local</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-i</span><span class="token plain"> PID</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">local</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-i</span><span class="token plain"> CNT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">local</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-i</span><span class="token plain"> INSTANCES</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">local</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-i</span><span class="token plain"> TOT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">local</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-i</span><span class="token plain"> TOTINSTANCES</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># read process list into cache</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">local</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">PSLIST</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">$(</span><span class="token string variable function" style="color:#d73a49">ps</span><span class="token string variable" style="color:#36acaa"> ax </span><span class="token string variable parameter variable" style="color:#36acaa">-o</span><span class="token string variable" style="color:#36acaa"> pid,user</span><span class="token string variable operator" style="color:#393A34">=</span><span class="token string variable" style="color:#36acaa">WIDE-COLUMN,command $COLSTRING</span><span class="token string variable" style="color:#36acaa">)</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">local</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">INOTIFY</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">$(</span><span class="token string variable function" style="color:#d73a49">find</span><span class="token string variable" style="color:#36acaa"> /proc/</span><span class="token string variable punctuation" style="color:#393A34">[</span><span class="token string variable number" style="color:#36acaa">0</span><span class="token string variable" style="color:#36acaa">-9</span><span class="token string variable punctuation" style="color:#393A34">]</span><span class="token string variable" style="color:#36acaa">*/fdinfo </span><span class="token string variable parameter variable" style="color:#36acaa">-type</span><span class="token string variable" style="color:#36acaa"> f </span><span class="token string variable operator file-descriptor important" style="color:#393A34">2</span><span class="token string variable operator" style="color:#393A34">&gt;</span><span class="token string variable" style="color:#36acaa">/dev/null </span><span class="token string variable operator" style="color:#393A34">|</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable function" style="color:#d73a49">xargs</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable function" style="color:#d73a49">grep</span><span class="token string variable" style="color:#36acaa"> ^inotify </span><span class="token string variable operator file-descriptor important" style="color:#393A34">2</span><span class="token string variable operator" style="color:#393A34">&gt;</span><span class="token string variable" style="color:#36acaa">/dev/null</span><span class="token string variable" style="color:#36acaa">)</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">local</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">INOTIFYCNT</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">$(</span><span class="token string variable builtin class-name" style="color:#36acaa">echo</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable string" style="color:#e3116c">&quot;</span><span class="token string variable string variable" style="color:#36acaa">$INOTIFY</span><span class="token string variable string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable operator" style="color:#393A34">|</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable function" style="color:#d73a49">cut</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable parameter variable" style="color:#36acaa">-d</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable string" style="color:#e3116c">&quot;/&quot;</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable parameter variable" style="color:#36acaa">-s</span><span class="token string variable" style="color:#36acaa"> --output-delimiter</span><span class="token string variable operator" style="color:#393A34">=</span><span class="token string variable string" style="color:#e3116c">&quot; &quot;</span><span class="token string variable" style="color:#36acaa">  </span><span class="token string variable parameter variable" style="color:#36acaa">-f</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable number" style="color:#36acaa">3</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable operator" style="color:#393A34">|</span><span class="token string variable function" style="color:#d73a49">uniq</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable parameter variable" style="color:#36acaa">-c</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable operator" style="color:#393A34">|</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable function" style="color:#d73a49">sed</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable parameter variable" style="color:#36acaa">-e</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable string" style="color:#e3116c">&#x27;s/:.*//&#x27;</span><span class="token string variable" style="color:#36acaa">)</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># unique instances per process is denoted by number of inotify FDs</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">local</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">INOTIFYINSTANCES</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">$(</span><span class="token string variable builtin class-name" style="color:#36acaa">echo</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable string" style="color:#e3116c">&quot;</span><span class="token string variable string variable" style="color:#36acaa">$INOTIFY</span><span class="token string variable string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable operator" style="color:#393A34">|</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable function" style="color:#d73a49">cut</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable parameter variable" style="color:#36acaa">-d</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable string" style="color:#e3116c">&quot;/&quot;</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable parameter variable" style="color:#36acaa">-s</span><span class="token string variable" style="color:#36acaa"> --output-delimiter</span><span class="token string variable operator" style="color:#393A34">=</span><span class="token string variable string" style="color:#e3116c">&quot; &quot;</span><span class="token string variable" style="color:#36acaa">   </span><span class="token string variable parameter variable" style="color:#36acaa">-f</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable number" style="color:#36acaa">3,5</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable operator" style="color:#393A34">|</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable function" style="color:#d73a49">sed</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable parameter variable" style="color:#36acaa">-e</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable string" style="color:#e3116c">&#x27;s/:.*//&#x27;</span><span class="token string variable operator" style="color:#393A34">|</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable function" style="color:#d73a49">uniq</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable operator" style="color:#393A34">|</span><span class="token string variable function" style="color:#d73a49">awk</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable string" style="color:#e3116c">&#x27;{print $1}&#x27;</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable operator" style="color:#393A34">|</span><span class="token string variable function" style="color:#d73a49">uniq</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable parameter variable" style="color:#36acaa">-c</span><span class="token string variable" style="color:#36acaa">)</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">local</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">INOTIFYUSERINSTANCES</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;$(echo &quot;</span><span class="token string variable" style="color:#36acaa">$INOTIFY</span><span class="token string" style="color:#e3116c">&quot; | cut -d &quot;/&quot; -s --output-delimiter=&quot; &quot;   -f 3,5 | sed -e &#x27;s/:.*//&#x27; | uniq |</span><br></span><span class="token-line" style="color:#393A34"><span class="token string" style="color:#e3116c">    	     while read PID FD; do echo </span><span class="token string variable" style="color:#36acaa">$PID</span><span class="token string" style="color:#e3116c"> </span><span class="token string variable" style="color:#36acaa">$FD</span><span class="token string" style="color:#e3116c"> </span><span class="token string variable" style="color:#36acaa">$(</span><span class="token string variable function" style="color:#d73a49">grep</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable parameter variable" style="color:#36acaa">-e</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable string" style="color:#e3116c">&quot;^ *</span><span class="token string variable string variable" style="color:#36acaa">${PID}</span><span class="token string variable string" style="color:#e3116c"> &quot;</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable operator" style="color:#393A34">&lt;&lt;&lt;</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable string" style="color:#e3116c">&quot;</span><span class="token string variable string variable" style="color:#36acaa">$PSLIST</span><span class="token string variable string" style="color:#e3116c">&quot;</span><span class="token string variable operator" style="color:#393A34">|</span><span class="token string variable function" style="color:#d73a49">awk</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable string" style="color:#e3116c">&#x27;{print $2}&#x27;</span><span class="token string variable" style="color:#36acaa">)</span><span class="token string" style="color:#e3116c">; done | cut -d&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;  -f 3 | sort | uniq -c |sort -nr)&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">set</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-e</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;&lt;&lt;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">$INOTIFYCNT</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token builtin class-name">read</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-rs</span><span class="token plain"> CNT PROC</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">do</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic"># count watches of processes found</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">${PROC}</span><span class="token string" style="color:#e3116c">,</span><span class="token string variable" style="color:#36acaa">${CNT}</span><span class="token string" style="color:#e3116c">,</span><span class="token string variable" style="color:#36acaa">$(</span><span class="token string variable builtin class-name" style="color:#36acaa">echo</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable string" style="color:#e3116c">&quot;</span><span class="token string variable string variable" style="color:#36acaa">$INOTIFYINSTANCES</span><span class="token string variable string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable operator" style="color:#393A34">|</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable function" style="color:#d73a49">grep</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable string" style="color:#e3116c">&quot; </span><span class="token string variable string variable" style="color:#36acaa">${PROC}</span><span class="token string variable string" style="color:#e3116c">$&quot;</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable operator" style="color:#393A34">|</span><span class="token string variable function" style="color:#d73a49">awk</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable string" style="color:#e3116c">&#x27;{print $1}&#x27;</span><span class="token string variable" style="color:#36acaa">)</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">done</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-v</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;,0,&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">                  </span><span class="token comment" style="color:#999988;font-style:italic"># remove entires without watches</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">sort</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-n</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-t</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;,&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-k</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2,3</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-r</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">         </span><span class="token comment" style="color:#999988;font-style:italic"># sort to begin with highest numbers</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">                                </span><span class="token comment" style="color:#999988;font-style:italic"># group commands so that $TOT is visible in the printf</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	    </span><span class="token assign-left variable environment constant" style="color:#36acaa">IFS</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;,&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">while</span><span class="token plain"> </span><span class="token builtin class-name">read</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-rs</span><span class="token plain"> PID CNT INSTANCES</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">do</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic"># show watches and corresponding process info</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token builtin class-name">printf</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;%</span><span class="token string variable" style="color:#36acaa">$((</span><span class="token string variable" style="color:#36acaa"> WLEN </span><span class="token string variable operator" style="color:#393A34">-</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable number" style="color:#36acaa">2</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable" style="color:#36acaa">))</span><span class="token string" style="color:#e3116c">d  %</span><span class="token string variable" style="color:#36acaa">$((</span><span class="token string variable" style="color:#36acaa"> WLEN </span><span class="token string variable operator" style="color:#393A34">-</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable number" style="color:#36acaa">2</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable" style="color:#36acaa">))</span><span class="token string" style="color:#e3116c">d     %s</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">$CNT</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">$INSTANCES</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">$(</span><span class="token string variable function" style="color:#d73a49">grep</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable parameter variable" style="color:#36acaa">-e</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable string" style="color:#e3116c">&quot;^ *</span><span class="token string variable string variable" style="color:#36acaa">${PID}</span><span class="token string variable string" style="color:#e3116c"> &quot;</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable operator" style="color:#393A34">&lt;&lt;&lt;</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable string" style="color:#e3116c">&quot;</span><span class="token string variable string variable" style="color:#36acaa">$PSLIST</span><span class="token string variable string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">)</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token assign-left variable" style="color:#36acaa">TOT</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">$((</span><span class="token variable" style="color:#36acaa"> TOT </span><span class="token variable operator" style="color:#393A34">+</span><span class="token variable" style="color:#36acaa"> CNT </span><span class="token variable" style="color:#36acaa">))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		</span><span class="token assign-left variable" style="color:#36acaa">TOTINSTANCES</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">$((</span><span class="token variable" style="color:#36acaa"> TOTINSTANCES </span><span class="token variable operator" style="color:#393A34">+</span><span class="token variable" style="color:#36acaa"> INSTANCES</span><span class="token variable" style="color:#36acaa">))</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">done</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	    </span><span class="token comment" style="color:#999988;font-style:italic"># These stats should be per-user as well, since inotify limits are per-user..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token builtin class-name">printf</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c">%</span><span class="token string variable" style="color:#36acaa">$((</span><span class="token string variable" style="color:#36acaa"> WLEN </span><span class="token string variable operator" style="color:#393A34">-</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable number" style="color:#36acaa">2</span><span class="token string variable" style="color:#36acaa"> </span><span class="token string variable" style="color:#36acaa">))</span><span class="token string" style="color:#e3116c">d  %s</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">$TOT</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;WATCHES TOTAL COUNT&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># the total across different users is somewhat meaningless, not printing for now.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">#            printf &quot;\n%$(( WLEN - 2 ))d  %s\n&quot; &quot;$TOTINSTANCES&quot; &quot;TOTAL INSTANCES COUNT&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;INotify instances per user (e.g. limits specified by fs.inotify.max_user_instances): &quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;INSTANCES    USER&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;-----------  ------------------&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">$INOTIFYUSERINSTANCES</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">column</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-t</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">echo</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">exit</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># get terminal width</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">declare</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-i</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">COLS</span><span class="token operator" style="color:#393A34">=</span><span class="token variable" style="color:#36acaa">$(</span><span class="token variable" style="color:#36acaa">tput cols </span><span class="token variable operator file-descriptor important" style="color:#393A34">2</span><span class="token variable operator" style="color:#393A34">&gt;</span><span class="token variable" style="color:#36acaa">/dev/null </span><span class="token variable operator" style="color:#393A34">||</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable builtin class-name" style="color:#36acaa">echo</span><span class="token variable" style="color:#36acaa"> </span><span class="token variable number" style="color:#36acaa">80</span><span class="token variable" style="color:#36acaa">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">declare</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-i</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">WLEN</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">declare</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">COLSTRING</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&quot;--columns </span><span class="token string variable" style="color:#36acaa">$((</span><span class="token string variable" style="color:#36acaa"> COLS </span><span class="token string variable operator" style="color:#393A34">-</span><span class="token string variable" style="color:#36acaa"> WLEN </span><span class="token string variable" style="color:#36acaa">))</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># get terminal width</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">$1</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;--limits&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">$1</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;-l&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    limits</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">exit</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">$1</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;--help&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">$1</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;-h&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    usage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">exit</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic"># added this line and moved some declarations to allow for the full display instead of a truncated version</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">$1</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;--full&quot;</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-o</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">$1</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;-f&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">unset</span><span class="token plain"> COLSTRING</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-n</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string variable" style="color:#36acaa">$1</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">then</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">printf</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c">Unknown parameter &#x27;</span><span class="token string variable" style="color:#36acaa">$1</span><span class="token string" style="color:#e3116c">&#x27;</span><span class="token string entity" style="color:#36acaa">\n</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token file-descriptor important">&amp;2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    usage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token builtin class-name">exit</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">fi</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">main</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><a href="https://github.com/fatso83/dotfiles/blob/master/utils/scripts/inotify-consumers" target="_blank" rel="noopener noreferrer">https://github.com/fatso83/dotfiles/blob/master/utils/scripts/inotify-consumers</a></p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/til/tags/inotify">inotify</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/til/tags/file-system">file system</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/til/2022/12/19/rsync and file renames">rsync and file renames</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2022-12-19T00:00:00.000Z">December 19, 2022</time></div></header><div class="markdown"><p><code>rsync</code> doesn&#x27;t handle file/folder renames well: if a folder containing lots of big files (a photos/videos library) is renamed in the source, then the existing files in the destination will be deleted, and all files will be copied again to the destination.</p>
<p><a href="https://github.com/bcpierce00/unison" target="_blank" rel="noopener noreferrer">Unison</a> appears to handle file renames, but what it actually does is detecting that the files already exist in the destination, and making a copy of them in the destination, from the destination. This saves bandwidth, but is still slow and will stress hard drives for no reason.</p>
<p>A tool made by one single person addresses this issue perfectly: <a href="https://github.com/m-manu/rsync-sidekick" target="_blank" rel="noopener noreferrer"><code>rsync-sidekick</code></a></p>
<p>The author mentions that the tool doesn&#x27;t make any changes, but to make sure of it, we can run it in a Docker container with readonly volumes. It will output a list of commands to rename and move stuff in the destination to reproduce the renames/moves made in the source.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="usage">Usage<a href="#usage" class="hash-link" aria-label="Direct link to Usage" title="Direct link to Usage">​</a></h3>
<ul>
<li>Build the container:</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> build </span><span class="token parameter variable" style="color:#36acaa">-t</span><span class="token plain"> rsync-sidekick </span><span class="token builtin class-name">.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>Run it:</li>
</ul>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">docker</span><span class="token plain"> run </span><span class="token parameter variable" style="color:#36acaa">--rm</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token parameter variable" style="color:#36acaa">-v</span><span class="token plain"> /</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">source-path</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">:/sync-src:ro </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token parameter variable" style="color:#36acaa">-v</span><span class="token plain"> /</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">destination-path</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">:/sync-dst:ro </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	rsync-sidekick </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	/bin/bash </span><span class="token parameter variable" style="color:#36acaa">-c</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;rsync-sidekick -shellscript /sync-src/ /sync-dst/ &amp;&amp; echo &amp;&amp; cat sync_actions_*.sh&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>
<p>Retrieve the output, check it visually, replace <code>sync-src</code> and <code>sync-dst</code>, and run it.</p>
</li>
<li>
<p>Run <code>rsync</code> on dry-run:</p>
</li>
</ul>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">rsync</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-ruvin</span><span class="token plain"> /</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">source-path</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/ /</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">destination-path</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ul>
<li>Check the output; if all is ok, run <code>rsync</code>:</li>
</ul>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">rsync</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">-ruvi</span><span class="token plain"> /</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">source-path</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/ /</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">destination-path</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">/</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="remote-directories">Remote directories<a href="#remote-directories" class="hash-link" aria-label="Direct link to Remote directories" title="Direct link to Remote directories">​</a></h3>
<p><code>rsync-sidekick</code> only supports local directories at the moment, so to use it with a remote one, we need to mount the directory locally. Example with SSH:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">mkdir</span><span class="token plain"> ~/remote-dir</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sshfs </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">server</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">:/</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">path-on-server</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> ~/remote-dir</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Then you can use <code>~/remote-dir</code> as a local directory.</p>
<p>To unmount it, run:</p>
<div class="language-sh codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-sh codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">fusermount </span><span class="token parameter variable" style="color:#36acaa">-u</span><span class="token plain"> ~/remote-dir</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/til/tags/rsync">rsync</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/til/2022/12/05/JSON stringify circular references">JSON stringify circular references</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2022-12-05T00:00:00.000Z">December 5, 2022</time></div></header><div class="markdown"><p>Not really a TIL, but more a knack: stringify an object containing circular references:</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">safeStringify</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">obj</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> indent </span><span class="token parameter operator" style="color:#393A34">=</span><span class="token parameter"> </span><span class="token parameter number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token keyword" style="color:#00009f">let</span><span class="token plain"> cache </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> retVal </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token known-class-name class-name">JSON</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">stringify</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		obj</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">key</span><span class="token parameter punctuation" style="color:#393A34">,</span><span class="token parameter"> value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">			</span><span class="token keyword" style="color:#00009f">typeof</span><span class="token plain"> value </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;object&quot;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> value </span><span class="token operator" style="color:#393A34">!==</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">				</span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> cache</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">includes</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">					</span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> </span><span class="token keyword nil" style="color:#00009f">undefined</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">// Duplicate reference found, discard key</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">					</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> cache</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">push</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">value</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> value </span><span class="token comment" style="color:#999988;font-style:italic">// Store value in our collection</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">				</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> value</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">		indent</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	cache </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword null nil" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">	</span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> retVal</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Use like:</p>
<div class="language-js codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-js codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token console class-name">console</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">log</span><span class="token punctuation" style="color:#393A34">(</span><span class="token function" style="color:#d73a49">safeStringify</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">event</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>From <a href="https://stackoverflow.com/questions/11616630/how-can-i-print-a-circular-structure-in-a-json-like-format" target="_blank" rel="noopener noreferrer">here</a>.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/til/tags/json">json</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/til/tags/stringify">stringify</a></li></ul></div></footer></article><article class="margin-bottom--xl"><header><h2 class="title_f1Hy"><a href="/til/2022/11/23/wget for FTP">wget for FTP</a></h2><div class="container_mt6G margin-vert--md"><time datetime="2022-11-23T00:00:00.000Z">November 23, 2022</time></div></header><div class="markdown"><p>Download the content of an FTP folder with <code>wget</code>:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">wget</span><span class="token plain"> </span><span class="token parameter variable" style="color:#36acaa">--user</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">username</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> --ask-password </span><span class="token parameter variable" style="color:#36acaa">-r</span><span class="token plain"> ftp://</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">url</span><span class="token operator" style="color:#393A34">&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Although it took minutes to download 10 MB...</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/til/tags/wget">wget</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/til/tags/ftp">ftp</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/til/tags/cli">cli</a></li><li class="tag_QGVx"><a class="tag_zVej tagRegular_sFm0" href="/til/tags/command">command</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 Zwyx.dev</div></div></div></footer></div>
</body>
</html>